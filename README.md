<div align="center">

# WhatsApp Client Agent

An AI-powered WhatsApp concierge that answers client messages using your company profile, service catalog, and escalation rules. Built with Next.js 14, works seamlessly on Vercel, and integrates with Twilio’s WhatsApp API.

</div>

## Features

- **Twilio-compatible webhook** — drop-in `/api/webhook` endpoint that responds to incoming WhatsApp messages with TwiML.
- **OpenAI-driven replies** — configurable prompt that understands your services, tone, and escalation policies.
- **Service catalog awareness** — describe offerings once via environment variables; responses stay on-brand.
- **Browser simulator** — test the experience locally with the interactive Agent Response Simulator.
- **Vercel-ready** — zero configuration deployment with the provided production URL.

## Project Structure

```
├── src
│   ├── app
│   │   ├── api
│   │   │   ├── simulate/route.ts     # Local testing endpoint
│   │   │   └── webhook/route.ts      # Twilio WhatsApp webhook
│   │   ├── globals.css               # Tailwind design tokens
│   │   └── page.tsx                  # Dashboard & simulator
│   └── lib
│       ├── agent.ts                  # Prompt & OpenAI integration
│       ├── config.ts                 # Environment variable parsing
│       └── twilio.ts                 # TwiML helpers
├── package.json
└── next.config.ts
```

## Prerequisites

- Node.js 18+
- npm 9+
- Twilio WhatsApp Sandbox or Business API number
- OpenAI API key with access to GPT-4o-class models

## Running Locally

```bash
npm install
npm run dev
```

Navigate to `http://localhost:3000` to preview the dashboard.

## Required Environment Variables

| Variable | Description |
| --- | --- |
| `OPENAI_API_KEY` | Used to generate WhatsApp replies. Required for production. |
| `COMPANY_NAME` | Appears in greetings and signatures. |
| `COMPANY_DESCRIPTION` | High-level summary for the system prompt. |
| `COMPANY_SERVICES` | JSON array describing services. See example below. |

### Optional Tweaks

- `AGENT_TONE` – Controls writing style. Example: `"friendly and concise"`.
- `AGENT_BUSINESS_HOURS` – Communicated in off-hours replies.
- `AGENT_ESCALATION_EMAIL` – Included when the agent escalates.
- `AGENT_FALLBACK_GENERIC`, `AGENT_FALLBACK_OUTSIDE_HOURS`, `AGENT_FALLBACK_ESCALATION` – Custom fallback copy.
- `AGENT_TEMPERATURE` – Creativity level (`0` – factual, `1` – creative).
- `OPENAI_MODEL` – Alternate model (`gpt-4o`, `gpt-4.1-mini`, etc.).

### Sample `COMPANY_SERVICES` Value

```json
[
  {
    "name": "Automation Blueprint",
    "description": "Two-week engagement that maps and documents your ideal customer journey with automation triggers.",
    "responseHighlights": [
      "Delivered in a collaborative FigJam board",
      "Includes automation-ready SOPs",
      "Leads to a tailored implementation plan"
    ]
  },
  {
    "name": "Done-For-You Implementation",
    "description": "Full build-out across CRM, WhatsApp, and email with analytics instrumentation.",
    "responseHighlights": [
      "Average go-live time: 10 business days",
      "Includes training for your internal team",
      "Support SLAs available at Bronze/Silver/Gold tiers"
    ]
  }
]
```

## Connecting Twilio WhatsApp

1. Enable the [Twilio WhatsApp Sandbox](https://console.twilio.com/us1/develop/sms/whatsapp/learn) or Business API and link your number.
2. Set the inbound message webhook URL to:
   ```
   https://agentic-83883b54.vercel.app/api/webhook
   ```
3. Add the environment variables above in your Vercel dashboard.
4. Send a test WhatsApp message; Twilio will call the webhook and receive a TwiML response generated by the agent.

> **Signature verification:** Production deployments should set `WHATSAPP_WEBHOOK_SECRET` and replace the placeholder verification in `src/lib/twilio.ts` with your preferred strategy (e.g. Twilio HMAC-SHA1 check).

## Deployment

This project is ready for Vercel. From the repository root:

```bash
npm run build
vercel deploy --prod --yes --token $VERCEL_TOKEN --name agentic-83883b54
```

After a successful deployment, verify the production URL:

```bash
curl https://agentic-83883b54.vercel.app
```

## Testing With The Simulator

The dashboard includes an **Agent Response Simulator** that calls the `/api/simulate` endpoint. Use it to iterate on tone, business hours, or service descriptions without sending live WhatsApp messages.

## Extending The Agent

- Add CRM synchronization in a new API route (e.g. HubSpot or Airtable).
- Swap OpenAI for another LLM by editing `src/lib/agent.ts`.
- Wire the webhook into a conversation history store (Redis, Supabase) for context-aware replies.

Happy automating!
